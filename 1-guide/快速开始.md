# 快速开始 - Lightence + FastAPI 集成

## ✅ 已完成的工作

### 1. 前端 API 适配
- ✅ 修改了 `src/api/auth.api.ts`，适配 FastAPI 后端接口
- ✅ 实现了用户模型转换功能
- ✅ 修改了密码重置表单，支持从 URL 获取 token

### 2. 集成文档
- ✅ 创建了详细的集成指南：`FastAPI后端集成指南.md`

## 🚀 快速启动步骤

### 第一步：配置后端

1. 进入后端项目目录：
```bash
cd E:\finance\full-stack-fastapi-template
```

2. 修改 `.env` 文件，添加 CORS 配置：
```env
FRONTEND_HOST=http://localhost:3000
BACKEND_CORS_ORIGINS=http://localhost:3000,http://localhost:5173
```

3. 启动后端：
```bash
docker compose watch
```

后端将在 `http://localhost:8000` 启动

### 第二步：配置前端

1. 进入前端项目目录：
```bash
cd E:\finance\lightence-ant-design-react-template
```

2. 创建 `.env` 文件：
```env
REACT_APP_BASE_URL=http://localhost:8000/api/v1
```

3. 安装依赖（如果还没有）：
```bash
yarn install
```

4. 启动前端：
```bash
yarn start
```

前端将在 `http://localhost:3000` 启动

### 第三步：测试登录

1. 打开浏览器访问：`http://localhost:3000`
2. 使用后端创建的第一个超级用户登录：
   - 邮箱：查看后端 `.env` 中的 `FIRST_SUPERUSER`
   - 密码：查看后端 `.env` 中的 `FIRST_SUPERUSER_PASSWORD`

## 📝 注意事项

1. **CORS 配置**：确保后端的 CORS 配置包含前端地址
2. **API 路径**：前端已配置为使用 `/api/v1` 前缀
3. **Token 存储**：登录成功后，Token 会自动存储到 localStorage
4. **用户信息**：用户信息会自动从 FastAPI 获取并转换为 Lightence 的格式

## 🔧 已修改的文件

- `src/api/auth.api.ts` - API 接口适配
- `src/components/auth/NewPasswordForm/NewPasswordForm.tsx` - 密码重置表单

## 📚 详细文档

查看 `FastAPI后端集成指南.md` 获取完整的集成说明和故障排除指南。

## ⚠️ 已知问题

1. **用户模型差异**：FastAPI 的用户模型与 Lightence 的 UserModel 有差异，已通过适配器函数处理
2. **密码重置流程**：FastAPI 使用邮件链接方式，需要从 URL 获取 token

## 🎯 下一步

1. 测试所有认证流程（登录、注册、密码重置）
2. 根据业务需求实现其他 API 接口
3. 优化错误处理和用户体验

